(l=>{let o;var r={settings:{surveyFields:["text","textarea","select","radio","checkbox","rating","likert_scale","net_promoter_score"]},init(){o=this.settings,l(r.ready)},ready(){r.buildUIActions(),r.likertSortable()},buildUIActions(){l(document).on("click","#wpforms-panel-field-settings-disable_entries, #wpforms-panel-field-settings-survey_enable, #wpforms-panel-field-settings-poll_enable",r.alertEnableEntries),l(document).on("change","#wpforms-panel-field-settings-survey_enable",function(){l(this).is(":checked")?l(".wpforms-field-option-row-survey").addClass("wpforms-hidden"):l(".wpforms-field-option-row-survey").removeClass("wpforms-hidden")}),l(document).on("wpformsFieldAdd",function(e,i,t){-1<l.inArray(t,o.surveyFields)&&l("#wpforms-panel-field-settings-survey_enable").is(":checked")&&l("#wpforms-field-option-row-"+i+"-survey").addClass("wpforms-hidden")}),l(document).on("wpformsFieldAdd",function(e,i,t){"likert_scale"===t&&r.likertSortable("#wpforms-field-option-"+i+" .choices-list")}),l(document).on("click",".wpforms-field-option-likert_scale .choices-list .add",function(e){r.likertChoiceAdd(e,l(this))}),l(document).on("click",".wpforms-field-option-likert_scale .choices-list .remove",function(e){r.likertChoiceDelete(e,l(this))}),l(document).on("input",".wpforms-field-option-likert_scale .choices-list input",function(){var e=l(this).closest(".choices-list").data("field-id");r.likertChoiceUpdate(e)}),l(document).on("input",".wpforms-field-option-row-lowest_label input, .wpforms-field-option-row-highest_label input",function(e){r.netPromoterUpdateLabels(e,l(this))}),l(document).on("change",".wpforms-field-option-likert_scale .wpforms-field-option-row-single_row input",function(){l(this).closest(".wpforms-field-option-group-inner").find(".wpforms-field-option-row-rows .choices-list").toggleClass("wpforms-hidden"),r.likertChoiceUpdate(l(this).closest(".wpforms-field-option-row").data("field-id"))}),l(document).on("change",".wpforms-field-option-likert_scale .wpforms-field-option-row-multiple_responses input",function(){r.likertChoiceUpdate(l(this).closest(".wpforms-field-option-row").data("field-id"))}),l(document).on("change",".wpforms-field-option-likert_scale .wpforms-field-option-row-style select",function(){var e=l(this),i=e.val(),e=e.parent().data("field-id");l("#wpforms-field-"+e).find("table").removeClass("classic modern").addClass(i)}),l(document).on("change",".wpforms-field-option-net_promoter_score .wpforms-field-option-row-style select",function(){var e=l(this),i=e.val(),e=e.parent().data("field-id");l("#wpforms-field-"+e).find("table").removeClass("classic modern").addClass(i)}),l(document).on("wpformsUndoRedoRun","#wpforms-builder",function(e,i,t){["ActionItemsAddRemoveCommand","ChoicesListReorderCommand"].includes(t.constructor?.id)&&t.args?.fieldId&&"likert_scale"===t.args?.fieldType&&r.likertChoiceUpdate(t.args?.fieldId)})},alertEnableEntries(){var i=l(this);if(i.is(":checked")){var t=l("#wpforms-panel-field-settings-disable_entries"),o=l("#wpforms-panel-field-settings-survey_enable"),s=l("#wpforms-panel-field-settings-poll_enable");let e="";if(i.is(t)){if(!o.is(":checked")&&!s.is(":checked"))return;e=wpforms_surveys_polls.alert_disable_entries}else{if(!t.is(":checked"))return;e=wpforms_surveys_polls.alert_enable_entries,i.prop("checked",!1)}l.alert({title:wpforms_builder.heads_up,content:e,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}})}},likertSortable(e){e=e||".wpforms-field-option-likert_scale .choices-list";let o=l("#wpforms-builder");l(e).sortable({items:"li",axis:"y",delay:100,opacity:.6,handle:".move",start(e,i){o.trigger("wpformsBeforeLikertScaleFieldChoiceDragStart",i)},stop(e,i){var t=i.item.parent().data("field-id");r.likertChoiceUpdate(t),o.trigger("wpformsLikertScaleFieldChoiceMove",i)},update(){}})},likertChoiceAdd(e,i){e.preventDefault();var e=l(i),i=e.parent(),e=e.closest(".choices-list"),t=e.data("field-id"),o=e.attr("data-next-id"),s=e.data("choice-type"),i=i.clone().insertAfter(i);i.attr("data-key",o),i.find("input").val("").attr("name","fields["+t+"]["+s+"]["+o+"]"),e.attr("data-next-id",++o),r.likertChoiceUpdate(t)},likertChoiceDelete(e,i){e.preventDefault();e=l(i),i=e.closest(".choices-list");1===i.find("li").length?l.alert({title:!1,content:wpforms_builder.error_choice,icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"]}}}):(e.parent().remove(),r.likertChoiceUpdate(i.data("field-id")))},likertChoiceUpdate(e){var i=l("#wpforms-field-option-"+e+"-single_row");let t={rows:{},columns:{},colCount:0,singleRow:i.is(":checked"),singleClass:i.is(":checked")?"single-row":"",inputType:l("#wpforms-field-option-"+e+"-multiple_responses").is(":checked")?"checkbox":"radio",style:l("#wpforms-field-option-"+e+"-style").val(),width:0};l("#wpforms-field-option-row-"+e+"-columns .choices-list li").each(function(){var e=l(this),i=e.data("key"),e=e.find("input").val();t.columns["c"+i]={key:i,value:e},t.colCount++}),l("#wpforms-field-option-row-"+e+"-rows .choices-list li").each(function(){var e=l(this),i=e.data("key"),e=e.find("input").val();t.rows["r"+i]={key:i,value:e}}),t.width=t.singleRow?100/t.colCount:80/t.colCount;i=wp.template("wpforms-likert-scale-preview");l("#wpforms-field-"+e).find("table").replaceWith(i(t))},netPromoterUpdateLabels(e,i){var t=i.closest(".wpforms-field-option-row").data("field-id"),o=i.val(),i=i.attr("id").includes("lowest")?".not-likely":".extremely-likely";l("#wpforms-field-"+t).find(i).text(o)}};r.init()})(jQuery);